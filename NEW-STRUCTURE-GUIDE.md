# ğŸ†• New Workshop Structure - Complete Guide

## ğŸ“‹ Major Changes Implemented

### âœ… 1. New Workshop Structure (From Options.xlsx)

**Old Structure:** 14 workshops (Image 1-3 with batches, Text 1-4 with options)

**New Structure:** 3 main options with sub-options

---

## ğŸ¯ New Workshop Options

### **Option 1: Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (11 ÙŠÙˆÙ…)**

**Type:** One Radio Button (user selects ONE option)

**Sub-Options (4 modules):**
1. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: Ø¯ÙˆØ± Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙˆÙ…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 13-14 ÙŠÙ†Ø§ÙŠØ±
2. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 27-29 ÙŠÙ†Ø§ÙŠØ±
3. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 4-5 ÙØ¨Ø±Ø§ÙŠØ±
4. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠÙŠÙ† - 9-12 ÙØ¨Ø±Ø§ÙŠØ±

---

### **Option 2: Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (11 ÙŠÙˆÙ…)**

**Type:** One Radio Button

**Sub-Options (4 modules):**
1. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: Ø¯ÙˆØ± Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙˆÙ…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 14-15 Ø£Ø¨Ø±ÙŠÙ„
2. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 28-30 Ø£Ø¨Ø±ÙŠÙ„
3. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - 10-11 Ù…Ø§ÙŠÙˆ
4. Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠÙŠÙ† - 18-21 Ù…Ø§ÙŠÙˆ

---

### **Option 3: Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„Ø¬Ù†Ø© Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª â€“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (ÙŠÙˆÙ…Ø§Ù†)**

**Type:** One Radio Button

**Sub-Options (2 dates):**
1. Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„: 29-30 Ù…Ø§Ø±Ø³
2. Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ: 6-7 Ù…Ø§ÙŠÙˆ

---

## ğŸ“Š Excel File Structure

### **File 1: test_workshop_revised_v3.xlsx (Attendee Data)**

| Column | Content | Example |
|--------|---------|---------|
| **Name** | Attendee name | Nadine Elkojok |
| **Email** | Email address | n.elkojok@cfg.sa |
| **Option1** | "Yes" if available | Yes |
| **Option2** | "Yes" if available | Yes |
| **Option3** | "Yes" if available | - |

**Sample Data:**
```
Name                 | Email                  | Option1 | Option2 | Option3
---------------------|------------------------|---------|---------|--------
Nadine Elkojok       | n.elkojok@cfg.sa       | Yes     | Yes     | Yes
Shaijal Ellikkal     | s.ellikkal@cfg.sa      | Yes     | -       | Yes
Mrs. Rana AlOqla     | r.aloqla@mof.gov.sa    | Yes     | Yes     | -
```

---

### **File 2: Options.xlsx (Workshop Definitions)**

This file defines the structure of each option:

| Field Name | Option Label and Description | Option Type |
|------------|------------------------------|-------------|
| **Option1** | Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ©... (11 ÙŠÙˆÙ…) | One Radio Button |
| (blank) | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: ... - 13-14 ÙŠÙ†Ø§ÙŠØ± | (sub-option) |
| (blank) | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: ... - 27-29 ÙŠÙ†Ø§ÙŠØ± | (sub-option) |
| **Option2** | Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ©... (11 ÙŠÙˆÙ…) | One Radio Button |
| (blank) | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: ... - 14-15 Ø£Ø¨Ø±ÙŠÙ„ | (sub-option) |
| **Option3** | Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„Ø¬Ù†Ø© Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª... | One Radio Button |
| (blank) | Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„: 29-30 Ù…Ø§Ø±Ø³ | (sub-option) |

---

## âœ… 2. Admin Panel Updates

### **Added Features:**

#### **A. Registrant Name Column**

**Before:**
```
Email                 | Workshop              | Registered At
----------------------|-----------------------|---------------
n.elkojok@cfg.sa      | Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ©...     | 2025-12-02
```

**After:**
```
Name              | Email              | Workshop           | Registered At
------------------|--------------------|--------------------|--------------
Nadine Elkojok    | n.elkojok@cfg.sa   | Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ©...  | 2025-12-02
```

#### **B. Export to Excel Functionality**

- âœ… **New Button:** "ğŸ“¥ Export to Excel"
- âœ… **Location:** Next to "Clear All Registrations" button
- âœ… **Functionality:**
  - Exports all registrations to Excel file
  - Filename: `registrations_YYYY-MM-DD.xlsx`
  - Includes: Name, Email, Workshop, Registered At
  - Column widths optimized for readability

---

## ğŸ¨ User Experience Changes

### **Registration Form Display:**

**Before:** Workshop name only

**After:** Workshop name + sub-options in a box

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—‹ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“          â”‚
â”‚   Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (11 ÙŠÙˆÙ…)                  â”‚
â”‚                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â€¢ Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: Ø¯ÙˆØ± Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡...       â”‚   â”‚
â”‚   â”‚   13-14 ÙŠÙ†Ø§ÙŠØ±                        â”‚   â”‚
â”‚   â”‚ â€¢ Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©...     â”‚   â”‚
â”‚   â”‚   27-29 ÙŠÙ†Ø§ÙŠØ±                        â”‚   â”‚
â”‚   â”‚ â€¢ Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©...          â”‚   â”‚
â”‚   â”‚   4-5 ÙØ¨Ø±Ø§ÙŠØ±                         â”‚   â”‚
â”‚   â”‚ â€¢ Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ù…Ø§Ù„ÙŠØ©...          â”‚   â”‚
â”‚   â”‚   9-12 ÙØ¨Ø±Ø§ÙŠØ±                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                â”‚
â”‚   30 Ù…Ù‚Ø§Ø¹Ø¯                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Import Process

### **Step-by-Step:**

1. **Prepare Files:**
   - `test_workshop_revised_v3.xlsx` - Attendee data with Option1, Option2, Option3 columns
   - `Options.xlsx` - Workshop definitions (for reference only, not imported)

2. **Import in Admin Panel:**
   ```
   1. Go to: http://localhost:3000/admin.html
   2. Click: "Single File Import"
   3. Upload: test_workshop_revised_v3.xlsx
   4. Set capacity for each option (e.g., 30)
   5. Click: "Import Data"
   ```

3. **Result:**
   ```
   âœ“ Imported 3 attendees
   âœ“ Imported 3 workshops
   ```

---

## ğŸ“¥ Export Registrations

### **How to Export:**

1. **Navigate to Registrations Tab:**
   ```
   Admin Panel â†’ Registrations Tab
   ```

2. **Click Export Button:**
   ```
   Click: "ğŸ“¥ Export to Excel"
   ```

3. **File Downloads:**
   ```
   Filename: registrations_2025-12-02.xlsx
   Location: Your Downloads folder
   ```

4. **Excel File Contains:**
   - **Name** - Full name of registrant
   - **Email** - Email address
   - **Workshop** - Full workshop name
   - **Registered At** - Date and time

---

## ğŸ§ª Testing Instructions

### **1. Start Application**
```bash
cd workshop-registration
npm install
node server.js
```

### **2. Import Data**
```
URL: http://localhost:3000/admin.html

Steps:
1. Click "Single File Import"
2. Upload test_workshop_revised_v3.xlsx
3. Set capacities (default: 30 per option)
4. Click "Import Data"

Expected Result:
âœ“ "Imported 3 attendees and 3 workshops"
```

### **3. Test Registration**
```
URL: http://localhost:3000/index.html

Steps:
1. Enter: n.elkojok@cfg.sa
2. Should see: 3 workshop options
3. Each option shows:
   - Main workshop title
   - Sub-options with dates in a box
   - Available spots
4. Select one option
5. Click "ØªØ³Ø¬ÙŠÙ„"

Expected Result:
âœ“ "ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!"
```

### **4. Verify Admin Panel**
```
URL: http://localhost:3000/admin.html

Registrations Tab:
âœ“ Shows: Name column (Nadine Elkojok)
âœ“ Shows: Email column
âœ“ Shows: Workshop name
âœ“ Shows: Registration date/time

Export Button:
âœ“ Click "ğŸ“¥ Export to Excel"
âœ“ File downloads: registrations_YYYY-MM-DD.xlsx
âœ“ Open file: Contains all data with proper formatting
```

---

## ğŸ“Š Technical Implementation

### **Server-Side Mapping:**

```javascript
const workshopOptionsMapping = {
  'Option1': {
    main: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (11 ÙŠÙˆÙ…)',
    subOptions: [
      'Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: ...',
      'Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: ...',
      'Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: ...',
      'Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: ...'
    ]
  },
  // ... Option2, Option3
};
```

### **Workshop Structure in Database:**

```javascript
{
  id: 'workshop_1',
  name: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (11 ÙŠÙˆÙ…)',
  description: 'Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø£ÙˆÙ„: ... | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: ... | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: ... | Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: ...',
  capacity: 30,
  subOptions: [...],
  originalColumn: 'Option1'
}
```

### **Frontend Display:**

```javascript
// Split description by | to show sub-options
if (workshop.description.includes('|')) {
  const subOpts = workshop.description.split('|');
  // Display each as bullet point
}
```

---

## âœ… Features Summary

| Feature | Status | Details |
|---------|--------|---------|
| **New Workshop Structure** | âœ… | 3 options with sub-options |
| **Sub-Options Display** | âœ… | Shows dates/modules in box |
| **Name Column in Admin** | âœ… | Shows registrant name |
| **Export to Excel** | âœ… | Downloads formatted Excel file |
| **Excel Column Widths** | âœ… | Optimized for readability |
| **Name in Export** | âœ… | Included in exported file |
| **Arabic Interface** | âœ… | Maintained throughout |
| **Ministry Branding** | âœ… | Logo and colors preserved |

---

## ğŸ“ Files Included

### **Test Data:**
- `test_workshop_revised_v3.xlsx` - 3 attendees with Option1/2/3
- `Options.xlsx` - Workshop structure reference

### **Application Files:**
- `server.js` - Updated with new mapping
- `public/index.html` - Updated to show sub-options
- `public/admin.html` - Updated with name column + export

### **Documentation:**
- `NEW-STRUCTURE-GUIDE.md` - This file
- `UPDATES-SUMMARY.md` - Previous updates
- All original documentation

---

## ğŸ¯ Key Differences from Old System

| Aspect | Old System | New System |
|--------|------------|------------|
| **Workshop Count** | 14 workshops | 3 workshops |
| **Structure** | Image/Text with batches | Options with sub-options |
| **Display** | Workshop name only | Name + sub-options box |
| **Type** | Multiple selections | One radio button per option |
| **Sub-Options** | Hidden | Visible with dates |
| **Admin Name Column** | âŒ | âœ… |
| **Excel Export** | âŒ | âœ… |

---

## ğŸš€ Ready to Use!

All updates have been implemented and tested. The system now:
- âœ… Uses the new 3-option structure
- âœ… Shows sub-options with dates clearly
- âœ… Displays registrant names in admin panel
- âœ… Exports registrations to Excel with one click

**Test with the included Excel files to verify everything works!** ğŸ‰
